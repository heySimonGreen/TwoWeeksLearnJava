# 11月30日

同名的人再来就诊时，注意提醒医生操作，不要来一个病人就直接新生成id。

输入日期自动生成年龄

医改之后自费、新医保

第一次来都是初诊

收据查询



号别录入：两种情况

1 挂号到科室，医生那一栏为空

2 挂号到科室，并且挂号到医生

解析失败：不开电子发票

按F9 弹出药名

诊断，两种，一种是自己输入，二种是F9中查看诊断码。一般是不能手打

处置里面不要开药品和检验检查。

护士转抄后，医嘱会变颜色，

转抄后 还有校对，转抄校对后，子会变为蓝色，表示可以对病人使用的。

停止医嘱，有停止时间，哪个护士校对的。

门诊挂号收费  按f1

## 一、门诊流程

### 1 挂号 - > 当日挂号

![image-20211130175615601](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211130175615601.png)

```
SELECT "CLINIC_FOR_REGIST"."CLINIC_LABEL", 
"CLINIC_FOR_REGIST"."TIME_DESC",
 "CLINIC_FOR_REGIST"."REGIST_PRICE",
  "CLINIC_INDEX"."CLINIC_DEPT", 
"CLINIC_INDEX"."DOCTOR", 
"CLINIC_INDEX"."DOCTOR_TITLE",
 "CLINIC_INDEX"."CLINIC_TYPE",
  "CLINIC_FOR_REGIST"."CURRENT_NO",
'', 0, "CLINIC_INDEX"."INPUT_CODE",
 "DEPT_DICT"."POSITION", 
"CLINIC_INDEX"."CLINIC_POSITION",
"CLINIC_INDEX"."CLINIC_INDEX" 
FROM 
"CLINIC_FOR_REGIST",
"CLINIC_INDEX",
"DEPT_DICT" 
WHERE ( "CLINIC_FOR_REGIST"."CLINIC_LABEL" = "CLINIC_INDEX"."CLINIC_LABEL" ) and ( "CLINIC_INDEX"."CLINIC_DEPT" = "DEPT_DICT"."DEPT_CODE" ) and ( 
"CLINIC_FOR_REGIST"."CLINIC_DATE" = to_date((select to_char(sysdate,'yyyy-MM-dd') from dual),'yyyy-mm-dd' ))
```

填写信息 分为两种（新建 和 通过id查询以往就诊病人）

新建

直接输入姓名等信息，系统会自动生成id 

这里如果系统中有相通的人名字，系统会显示出来，可以供操作员选择，也可以避免为同一个病人重复生成多个唯一索引。

```
select patient_id,name,name_phonetic,sex,date_of_birth,nation,identity,charge_type,mailing_address,phone_number_home,id_no from 
pat_master_index where name=:name
:name = '陈伟'
```

​                                                                                                                                                                                                                                                                                                                                                                           

### 2 挂号信息填写完毕后点击挂号，部分比较重要的sql

![image-20211130230559633](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211130230559633.png)

```
select registration_limits , appointment_limits , current_no , registration_num from clinic_for_regist where clinic_date =:1 
and clinic_label =:2 and time_desc =:3
:1 = '2021/11/30'
:2 = '产科-刘苹'
:3 = '白天'
----------------------------------
Timestamp: 22:53:12.405
select count ( *) from clinic_master where mode_code ='A' and visit_date =:1 and clinic_label =:2 and visit_time_desc =:3 and 
returned_date is null
:1 = '2021/11/30'
:2 = '产科-刘苹'
:3 = '白天'

Timestamp: 22:53:12.841
select ID_START_VALUE , ID_CURRENTLY_VALUE , ID_LENGTH , ID_UPGRADE , ID_SQL from auto_setting_id where SERIAL_NO =:1
----------------------------------
Timestamp: 22:53:12.877
update auto_setting_id set ID_CURRENTLY_VALUE =:1 + 1 where SERIAL_NO =:2
:1 = 44438

Timestamp: 22:53:12.926
select count ( *) from pat_master_index where patient_id =:1
:1 = 'M0044438'
----------------------------------
Timestamp: 22:53:12.981
select patient_id from pat_master_index where patient_id =:1
:1 = 'M0044438'
Insert into pat_master_index ( patient_id , name , name_phonetic , sex , date_of_birth , charge_type , identity , birth_place , 
vip_indicator , create_date , operator , unit_in_contract , PHONE_NUMBER_HOME , MAILING_ADDRESS , province , city , county , 
detailed_address , id_no ) values ( :1 , :2 , :3 , :4 , :5 , :6 , :7 , :8 , 0 , sysdate , :9 , :10 , :11 , :12 , :13 , :14 , 
:15 , :16 , :17 )
:1 = 'M0044438'
:2 = '陈伟test'
:3 = 'CHEN WEI TEST'
:4 = '男'
:5 = '1997/9/9'
:6 = '自费'
:7 = '一般人员'
:8 = ''
:9 = '管理员'
:10 = ''
:11 = ''
:12 = <NULL>
:13 = <NULL>
:14 = <NULL>
:15 = <NULL>
:16 = <NULL>
:17 = <NULL>
----------------------------------
Timestamp: 22:53:13.388
SELECT TO_CHAR ( SYSDATE , 'yyyymmdd' ) || LPAD ( TO_CHAR ( OUTPBILL.SQ_RCPT_NUMBER.NEXTVAL ) , 6 , '0' ) , 
OUTPBILL.SQ_RCPT_NUMBER.NEXTVAL FROM DUAL
----------------------------------
Timestamp: 22:53:13.424
select count ( *) from clinic_master where visit_date =trunc ( sysdate ) and visit_no =:1
:1 = 542
----------------------------------
Timestamp: 22:53:13.473
select clinic_type , clinic_position , clinic_dept , doctor from CLINIC_INDEX where CLINIC_LABEL =:1
:1 = '产科-刘苹'
----------------------------------
Timestamp: 22:53:13.524
select id , id_no , name from staff_dict where emp_no =:1
:1 = 'LP'
----------------------------------
Timestamp: 22:53:13.558
select price_item from clinic_type_setting where charge_item =:1 and clinic_type =:2
:1 = '诊察费'
:2 = '普通号'
----------------------------------
Timestamp: 22:53:13.619
select item_class , item_spec , price from current_price_list where item_code =:1
:1 = 'def00000126'
----------------------------------
Timestamp: 22:53:13.667
select PRICE_COEFF_NUMERATOR , PRICE_COEFF_DENOMINATOR from CHARGE_PRICE_SCHEDULE where charge_type =:1
:1 = '自费'
----------------------------------
Timestamp: 22:53:13.718
select charge_special_indicator from CHARGE_PRICE_SCHEDULE where charge_type =:1
:1 = '自费'
----------------------------------
Timestamp: 22:53:13.769
SELECT proportion_numerator , proportion_denominator , free_limit FROM charge_special_except_dict WHERE charge_type =:1 AND 
item_class =:2 AND ( item_code =:3 OR item_code ='*' ) AND ( item_spec =:4 OR item_spec ='*' )
:1 = '自费'
:2 = 'D'
:3 = 'def00000126'
:4 = '/'
----------------------------------
Timestamp: 22:53:13.861
SELECT proportion_numerator , proportion_denominator , free_limit FROM charge_special_item_dict WHERE charge_type =:1 AND 
item_class =:2 AND ( item_code =:3 OR item_code ='*' ) AND ( item_spec =:4 OR item_spec ='*' )
:1 = '自费'
:2 = 'D'
:3 = 'def00000126'
:4 = '/'
----------------------------------
Timestamp: 22:53:13.952
select calculate_type , calculate_value from clinic_type_charge_dict where clinic_type =:1 and regist_type =:2 and charge_item 
=:3
:1 = '普通号'
:2 = '初诊'
:3 = '诊察费'
----------------------------------
Timestamp: 22:53:14.033
SELECT VISIT_NO.NEXTVAL FROM DUAL
----------------------------------
Timestamp: 22:53:14.069
select dept_name from dept_dict where dept_code =:1
:1 = '3702'
----------------------------------
Timestamp: 22:53:14.117
insert into outpbill.clinic_payments_money ( visit_date , visit_no , payment_no , money_type , payment_amount , refunded_amount 
) values ( :1 , :2 , 1 , '现金' , :3 , '0' )
:1 = '2021/11/30'
:2 = 1295
:3 = '9'
```

### 测试账号id

M0044437

### 3 点击确定挂号收费

![image-20211130230534392](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211130230534392.png)

```
select registration_limits , appointment_limits , current_no , registration_num from clinic_for_regist where clinic_date =:1 
and clinic_label =:2 and time_desc =:3
:1 = '2021/11/30'
:2 = '产科-刘苹'
:3 = '白天'
----------------------------------
Timestamp: 23:03:47.598
select count ( *) from clinic_master where mode_code ='A' and visit_date =:1 and clinic_label =:2 and visit_time_desc =:3 and 
returned_date is null
:1 = '2021/11/30'
:2 = '产科-刘苹'
:3 = '白天'
----------------------------------
Timestamp: 23:03:47.638
update clinic_for_regist set current_no =:1 + 1 , registration_num =:2 + 1 where clinic_date =:3 and clinic_label =:4 and 
time_desc =:5 and current_no =:6
:1 = 3
:2 = 1
:3 = '2021/11/30'
:4 = '产科-刘苹'
:5 = '白天'
:6 = 3
----------------------------------
Timestamp: 23:03:47.695
select count ( *) from clinic_master where mode_code ='A' and visit_date =:1 and clinic_label =:2 and visit_time_desc =:3 and 
returned_date is null and serial_no =:4
:1 = '2021/11/30'
:2 = '产科-刘苹'
:3 = '白天'
:4 = 3
----------------------------------
Timestamp: 23:03:47.758
Insert Into clinic_master ( VISIT_DATE , VISIT_NO , CLINIC_LABEL , VISIT_TIME_DESC , SERIAL_NO , PATIENT_ID , NAME , 
NAME_PHONETIC , SEX , AGE , Identity , CHARGE_TYPE , INSURANCE_TYPE , INSURANCE_NO , UNIT_IN_CONTRACT , CLINIC_TYPE , 
FIRST_VISIT_INDICATOR , SYMPTOM , VISIT_DEPT , DOCTOR , MR_PROVIDEd_INDICATOR , REGISTRATION_STATUS , REGISTERING_DATE , 
REGIST_FEE , CLINIC_FEE , OTHER_FEE , OPERATOR , clinic_charge , mode_code , card_name , card_no , pay_way , invoice_no , 
CLINIC_NO , FUND_PAY , tradeno , rcpt_no ) Values ( :1 , :2 , :3 , :4 , :5 , :6 , :7 , :8 , :9 , :10 , :11 , :12 , :13 , :14 , 
:15 , :16 , :17 , :18 , :19 , :20 , :21 , 1 , :22 , :23 , :24 , :25 , :26 , :27 , 'A' , :28 , :29 , :30 , :31 , :32 , :33 , :34 
, :35 )
:1 = '2021/11/30'
:2 = 1296
:3 = '产科-刘苹'
:4 = '白天'
:5 = 3
:6 = 'M0044437'
:7 = '陈伟test'
:8 = 'CHEN WEI TEST'
:9 = '男'
:11 = '一般人员'
:12 = '自费'
:13 = <NULL>
:14 = <NULL>
:15 = ''
:16 = '普通号'
:18 = ''
:19 = '3702'
:20 = 'LP'
:22 = '2021/11/30 23:03:47'
:23 = '0.00'
:24 = '9.00'
:25 = '0.00'
:26 = '2586'
:27 = '9.00'
:28 = '现金'
:29 = <NULL>
:30 = '现金'
:31 = ''
:32 = '2021113000543'
:33 = '0'
:34 = ''
:35 = ''
----------------------------------
Timestamp: 23:03:48.149
Select sysdate From dual
----------------------------------
Timestamp: 23:03:48.191
select a.mailing_address from pat_master_index a where a.patient_id =:1
:1 = 'M0044437'
----------------------------------
Timestamp: 23:03:48.232
select a.user_id from users a where a.user_name =:1
:1 = '管理员'
----------------------------------
Timestamp: 23:03:48.286
SELECT "APP_CONFIGER_PARAMETER"."APP_NAME", "APP_CONFIGER_PARAMETER"."DEPT_CODE", "APP_CONFIGER_PARAMETER"."EMP_NO", 
"APP_CONFIGER_PARAMETER"."PARAMETER_NAME", "APP_CONFIGER_PARAMETER"."PARAMETER_VALUE", "APP_CONFIGER_PARAMETER"."POSITION" FROM 
"APP_CONFIGER_PARAMETER" WHERE "APP_CONFIGER_PARAMETER"."PARAMETER_NAME" = :ls_parmeter_name
:ls_parmeter_name = 'REG_PRINT'
----------------------------------
Timestamp: 23:03:48.334
select dept_name from dept_dict where dept_code =:1
:1 = '3702'
----------------------------------
Timestamp: 23:03:49.108
Successful commit.
----------------------------------
Timestamp: 23:03:49.128
SELECT "APP_CONFIGER_PARAMETER"."APP_NAME", "APP_CONFIGER_PARAMETER"."DEPT_CODE", "APP_CONFIGER_PARAMETER"."EMP_NO", 
"APP_CONFIGER_PARAMETER"."PARAMETER_NAME", "APP_CONFIGER_PARAMETER"."PARAMETER_VALUE", "APP_CONFIGER_PARAMETER"."POSITION" FROM 
"APP_CONFIGER_PARAMETER" WHERE "APP_CONFIGER_PARAMETER"."PARAMETER_NAME" = :ls_parmeter_name
:ls_parmeter_name = 'PRINT_BARCODE'
----------------------------------
Timestamp: 23:03:49.168
Successful commit.
----------------------------------
Timestamp: 23:03:49.178
select clinic_charge + fund_pay from clinic_master where visit_date =:1 and visit_no =:2
:1 = '2021/11/30'
:2 = 1296
----------------------------------
Timestamp: 23:04:00.608
select count ( 1 ) from clinic_error_electronic where rcpt_no =:1 AND visit_date =:2 AND visit_no =:3
:1 = '2021113000543'
:2 = '2021/11/30'
:3 = 1296
----------------------------------
Timestamp: 23:04:00.678
insert into clinic_error_electronic ( rcpt_no , is_arrears , arrears_reason , visit_date , visit_no ) values ( :1 , 1 , '' , :2 
, :3 )
:1 = '2021113000543'
:2 = '2021/11/30'
:3 = 1296
----------------------------------
Timestamp: 23:04:00.731
Successful commit.
----------------------------------
Timestamp: 23:04:04.553
select patient_id , serial_no from clinic_master where visit_date =:1 and clinic_no =:2
:1 = '2021/11/30'
:2 = '2021113000543'
----------------------------------
Timestamp: 23:04:04.606
select name from pat_master_index where patient_id =:1
:1 = 'M0044437'
----------------------------------
Timestamp: 23:04:05.500
select bill_batch_code , bill_no , random from clinic_electronic_bills where rcpt_no =:1 and clinic_date =:2 and clinic_no =:3
:1 = '2021113000543'
:2 = '2021/11/30'
----------------------------------
Timestamp: 23:04:05.557
select count ( 1 ) from insurance_settle_master where settle_rcpt_no =:1
:1 = '2021113000543'
----------------------------------
Timestamp: 23:04:05.598
select fund_pay , clinic_charge , ( clinic_charge + fund_pay ) , operator from clinic_master where visit_date =:1 and visit_no 
=:2
:1 = '2021/11/30'
----------------------------------
Timestamp: 23:04:05.643
select sysdate from dual
----------------------------------
Timestamp: 23:04:05.729
select bill_qrcode                        from clinic_electronic_bills where rcpt_no ='2021113000543' and clinic_date 
=TO_DATE('30-11-2021','DD-MM-YYYY') and clinic_no =1296
----------------------------------
Timestamp: 23:04:06.618
SELECT '' rcpt_no,'' name,'' patient_id,'诊察费' charge_type,nvl(a.insurance_no,'无') insurance_no,'' inp_no, b.dept_name 
dept_name,'' serial_no,a.clinic_label,('金额:'||a.clinic_fee),'0' ybzhzf,'' ybtczf,'' ybdy, '' ybyydz ,'' ybqtzf,'' ybzhye,'0' 
zfje, '' zfsm,'0'zje, '未知' operator, '' con_date,'' bill_batch_code, '' bill_no, '' random,'' print_date from clinic_master a,
dept_dict b where a.visit_dept = b.dept_code and visit_date = :ldt_visit_date and visit_no = :ll_visit_no
:ldt_visit_date = '2021/11/30'
:ll_visit_no = 1296
```

### 4 门诊医生站登录

这里只能登录看病医生的账号才能给病人看病，否则没有权限。

![image-20211130231648722](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211130231648722.png)

```
----------------------------------
Timestamp: 23:16:19.567
SELECT "OUTP_DOCTOR_SCHEDULE"."DOCTOR", "OUTP_DOCTOR_SCHEDULE"."CLINIC_DURATION", "OUTP_DOCTOR_SCHEDULE"."QUEUE_NAME", sysdate 
as "CLINIC_DATE" FROM "OUTP_DOCTOR_SCHEDULE" WHERE ( "OUTP_DOCTOR_SCHEDULE"."CLINIC_DEPT" = :as_deptcode ) AND ( 
"OUTP_DOCTOR_SCHEDULE"."DOCTOR_NO" = :as_username ) AND ( "OUTP_DOCTOR_SCHEDULE"."DAY_OF_WEEK" = :an_daynum )
:as_deptcode = '3702'
:as_username = 'LP'
:an_daynum = 2
```



### 5 添加处方

![image-20211130232732429](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211130232732429.png)

```
----------------------------------
Timestamp: 23:21:35.083
SELECT proportion_numerator , proportion_denominator , free_limit FROM charge_special_item_dict WHERE charge_type =:1 AND 
item_class =:2 AND ( item_code =:3 OR item_code ='*' ) AND ( item_spec =:4 OR item_spec ='*' )
:1 = '自费'
:2 = 'A'
:3 = '3202003SS0'
:4 = '0.3g*24陕西方舟'
----------------------------------
Timestamp: 23:25:53.202
Select dose_per_unit From drug_dict where drug_code =:1 And drug_spec =:2 And units =:3 And dose_units =:4
:1 = '3202003SS0'
:2 = '0.3g*24'
:3 = '盒'
:4 = 'g'
----------------------------------
Timestamp: 23:25:53.278
Select sum ( quantity ) From drug_stock Where drug_code =:1 And package_spec =:2 And firm_id =:3 And Storage =:4 And 
supply_indicator ='1'
:1 = '3202003SS0'
:2 = '0.3g*24'
:3 = '陕西方舟'
:4 = '0703'
Timestamp: 23:25:57.298
select max ( item_class ) from price_list where item_code =:1
:1 = '3202003SS0'
----------------------------------
Timestamp: 23:26:05.176
Select separable From drug_dispens_property Where dispensary =:1 And drug_code =:2
:1 = '0703'
:2 = '3202003SS0'
----------------------------------
Timestamp: 23:26:05.239
Select code_his , yb_his_name From his_vs_bjyb_catalog Where item_class =:1 And item_code =:2 And spec =:3
:1 = 'A'
:2 = '3202003SS0'
:3 = '0.3g*24陕西方舟'
----------------------------------
Timestamp: 23:26:05.317
SELECT "PRICE_ITEM_NAME_DICT"."ITEM_NAME", "CLINIC_VS_CHARGE"."CHARGE_ITEM_CLASS", "CLINIC_VS_CHARGE"."CHARGE_ITEM_SPEC", 
"CLINIC_VS_CHARGE"."CHARGE_ITEM_CODE", "PRICE_ITEM_NAME_DICT"."ITEM_CODE", "CLINIC_VS_CHARGE"."UNITS", 
"CLINIC_VS_CHARGE"."AMOUNT" FROM "CLINIC_VS_CHARGE", "CLINIC_ITEM_NAME_DICT", "PRICE_ITEM_NAME_DICT" WHERE ( 
"CLINIC_VS_CHARGE"."CLINIC_ITEM_CLASS" = "CLINIC_ITEM_NAME_DICT"."ITEM_CLASS" ) and ( "CLINIC_VS_CHARGE"."CLINIC_ITEM_CODE" = 
"CLINIC_ITEM_NAME_DICT"."ITEM_CODE" ) and ( "CLINIC_VS_CHARGE"."CHARGE_ITEM_CLASS" = "PRICE_ITEM_NAME_DICT"."ITEM_CLASS" ) and 
( "CLINIC_VS_CHARGE"."CHARGE_ITEM_CODE" = "PRICE_ITEM_NAME_DICT"."ITEM_CODE" ) and ( "CLINIC_ITEM_NAME_DICT"."ITEM_NAME" = 
:as_admin ) AND ( "PRICE_ITEM_NAME_DICT"."STD_INDICATOR" = 1 ) AND ( "CLINIC_ITEM_NAME_DICT"."ITEM_CLASS" = :as_class )
:as_admin = '遵医嘱'
:as_class = 'E'
```

### 6 保存处方信息，此时还没收费

![image-20211130233006234](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211130233006234.png)

```
----------------------------------
Timestamp: 23:29:22.847
update app_configer_parameter set PARAMETER_VALUE =:1 where app_name =:2 and DEPT_CODE =:3 and EMP_NO =:4 and upper ( 
PARAMETER_NAME ) =:5
:1 = '1'
:2 = 'OUTPDOCT'
:3 = '3702'
:4 = '*'
:5 = 'PRESCNO'
```

### 7 病人去到门诊缴费

输入Id，系统会自动查询此id补全其他信息。但只输入姓名不行。

![image-20211130233759322](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211130233759322.png)

```
----------------------------------
Timestamp: 23:36:05.053
SELECT "OUTP_PRESC_T"."VISIT_DATE" visit_date, "OUTP_PRESC_T"."VISIT_NO" visit_no,
(select patient_id from outp_orders where serial_no = OUTP_PRESC_T.SERIAL_NO ) patient_id,
"OUTP_PRESC_T"."SERIAL_NO" serial_no, "OUTP_PRESC_T"."PRESC_NO" presc_no, "OUTP_PRESC_T"."ITEM_NO" item_no, 
"OUTP_PRESC_T"."ITEM_CLASS" item_class, "OUTP_PRESC_T"."DRUG_CODE" item_code, "OUTP_PRESC_T"."DRUG_NAME" item_name, 
"OUTP_PRESC_T"."DRUG_SPEC" item_spec, "OUTP_PRESC_T"."FIRM_ID" firm_id, "OUTP_PRESC_T"."UNITS" units, "OUTP_PRESC_T"."AMOUNT" 
amount, "OUTP_PRESC_T"."DOSAGE" dosage, "OUTP_PRESC_T"."DOSAGE_UNITS" dosage_units, "OUTP_PRESC_T"."ADMINISTRATION" 
administration, "OUTP_PRESC_T"."FREQUENCY" frequency, "OUTP_PRESC_T"."CHARGE_INDICATOR" charge_indicator, 
"OUTP_PRESC_T"."DISPENSARY" PERFORMED_BY, "OUTP_PRESC_T"."REPETITION" repetition, "OUTP_PRESC_T"."ORDER_NO" order_no, 
"OUTP_PRESC_T"."SUB_ORDER_NO" sub_order_no,
"OUTP_PRESC_T".getdrug_flag, "OUTP_PRESC_T".presc_attr,
"OUTP_PRESC_T".freq_detail,
"OUTP_ORDERS_T"."DOCTOR" doctor, "OUTP_ORDERS_T"."ORDERED_BY" ordered_by
FROM "OUTP_PRESC_T", "OUTP_ORDERS_T" WHERE ( "OUTP_PRESC_T"."VISIT_NO" = "OUTP_ORDERS_T"."VISIT_NO" ) and ( 
"OUTP_PRESC_T"."VISIT_DATE" = "OUTP_ORDERS_T"."VISIT_DATE" ) and ( "OUTP_PRESC_T"."SERIAL_NO" = "OUTP_ORDERS_T"."SERIAL_NO" ) 
and "OUTP_ORDERS_T"."VISIT_DATE" >= :visit_date and
("OUTP_ORDERS_T"."VISIT_NO" = :visit_no or :visit_no = 0) and
(patient_id = :patient_id or :patient_id = '*')
:visit_date = '2021/11/28'
:visit_no = 0
:patient_id = 'M0044437'
----------------------------------
Timestamp: 23:36:05.110
Select nvl ( abidance , 0 ) From outp_presc Where serial_no =:1 And order_no =:2 And sub_order_no =:3 And item_class =:4
:1 = '902556'
:2 = 1
:3 = 1
:4 = 'A'
```

### 8 按F1，进行缴费

![image-20211130233914905](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211130233914905.png)

```
*********************************
----------------------------------
Timestamp: 23:39:52.652
select count ( 1 ) from outp_error_electronic where rcpt_no =:1
:1 = '20211130000545'
----------------------------------
Timestamp: 23:39:52.690
insert into outp_error_electronic ( rcpt_no ) values ( :1 )
:1 = '20211130000545'
----------------------------------
Timestamp: 23:39:52.716
Successful commit.
----------------------------------
Timestamp: 23:39:53.621
select patient_id , charge_type , nvl ( insurance_no , '无' ) , nvl ( total_costs , '0' ) , visit_date from outp_rcpt_master 
where rcpt_no =:1
:1 = '20211130000545'
----------------------------------
Timestamp: 23:39:53.658
select name from pat_master_index where patient_id =:1
:1 = 'M0044437'
----------------------------------
Timestamp: 23:39:53.709
select nvl ( yb_tczf , '0' ) , nvl ( yb_zfzf , '0' ) , nvl ( yb_gwybz , '0' ) , nvl ( yb_xjzf , '0' ) , nvl ( yb_delpje , '0' ) 
, nvl ( yb_qfxgwyfh , '0' ) , nvl ( yb_yydz , '0' ) , nvl ( left_money , '0' ) , nvl ( total_charges-yb_xjzf , '0' ) , nvl ( 
yb_mzjz , '0' ) from insurance_settle_master where settle_rcpt_no =:1
:1 = '20211130000545'
----------------------------------
Timestamp: 23:39:53.751
select count ( 1 ) from insurance_settle_master where settle_rcpt_no =:1
:1 = '20211130000545'
----------------------------------
Timestamp: 23:39:55.404
select bill_batch_code , bill_no , random from outp_electronic_bills where rcpt_no =:1
:1 = '20211130000545'
----------------------------------
Timestamp: 23:39:55.434
select bill_qrcode                        from outp_electronic_bills where rcpt_no ='20211130000545'
----------------------------------
Timestamp: 23:39:57.071
SELECT '' rcpt_no,
'' name,
'' patient_id,
'' charge_type,
'' insurance_no,
'' inp_no,
'' dept_name,
item_name,
item_spec,
decode(substr('单价:' || item_price, 4, 1), '.', '单价:'||'0' || item_price, '单价:'||item_price),
(amount || units),
decode(substr('金额:' || costs, 4, 1), '.', '金额:'||'0' || costs, '金额:'||costs),
'' ybzhzf,
'' ybtczf,
'' ybqtzf,
'' ybzhye,
'' zfje,
'' zfsm,
'' zje,
'' operator,
'' con_date,
'' bill_batch_code,
'' bill_no,
'' random,
'' print_date,
' ' tczf,' ' ybzhzf,' ' ybyydz,' ' ybzfje,' ' zje,' ' ybkye,' ' ybdy
from outp_bill_items
where rcpt_no = :rcpt_no
:rcpt_no = '20211130000545'
```

### 9 再次进入门诊医生工作站，就诊完毕

![image-20211130234949781](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211130234949781.png)

重新进入门诊医生站忘记打开sql监控了。。。



## 二、住院流程

患者住院信息管理 ->  患者住院登记

![image-20211201000029523](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211201000029523.png)

```
----------------------------------
Timestamp: 00:00:38.587
update PAT_MASTER_INDEX Set INP_NO =:1 , NAME =:2 , NAME_PHONETIC =:3 , SEX =:4 , DATE_OF_BIRTH =:5 , BIRTH_PLACE =:6 , 
CITIZENSHIP =:7 , NATION =:8 , id_no =:9 , Identity =:10 , CHARGE_TYPE =:11 , UNIT_IN_CONTRACT =:12 , MAILING_ADDRESS =:13 , 
ZIP_CODE =:14 , NEXT_OF_KIN =:15 , RELATIONSHIP =:16 , NEXT_OF_KIN_ADDR =:17 , NEXT_OF_KIN_ZIP_CODE =:18 , NEXT_OF_KIN_PHONE 
=:19 , OPERATOR =:20 , patient_class =:21 , phone_number_home =:22 , household_address =:23 , phone_number_business =:24 where 
pat_master_index.patient_id =:25
:1 = 'C02122'
:2 = '陈伟TEST'
:3 = 'CHEN WEI TEST'
:4 = '男'
:5 = '1997/9/9'
:6 = '340803'
:7 = 'AL'
:8 = '白族'
:9 = <NULL>
:10 = '一般人员'
:11 = '自费'
:12 = <NULL>
:13 = 'cq'
:14 = <NULL>
:15 = <NULL>
:16 = <NULL>
:17 = 'cq'
:18 = ''
:19 = <NULL>
:20 = '管理员'
:21 = <NULL>
:22 = <NULL>
:23 = 'cq'
:24 = <NULL>
:25 = 'M0044437'
----------------------------------
Timestamp: 00:00:38.896
Insert Into PATS_IN_HOSPITAL ( PATIENT_ID , VISIT_ID , WARD_CODE , DEPT_CODE , ADMISSION_DATE_TIME , DIAGNOSIS , 
PATIENT_CONDITION , GUARANTOR , GUARANTOR_ORG , GUARANTOR_PHONE_NUM , PREPAYMENTS , TOTAL_COSTS , TOTAL_CHARGES , 
SETTLED_INDICATOR ) Values ( :1 , :2 , Null , Null , :3 , :4 , Null , :5 , :6 , :7 , 0 , 0 , 0 , 0 )
:1 = 'M0044437'
:3 = '2021/11/30 23:59:04'
:4 = '不详'
:5 = ''
:6 = ''
:7 = ''
----------------------------------
Timestamp: 00:00:38.983
Insert Into DIAGNOSIS ( PATIENT_ID , VISIT_ID , DIAGNOSIS_TYPE , DIAGNOSIS_NO , DIAGNOSIS_DESC , DIAGNOSIS_CODE , 
DIAGNOSIS_DATE ) Values ( :1 , :2 , '1' , 1 , :3 , :4 , :5 )
:1 = 'M0044437'
:3 = '不详'
:4 = <NULL>
:5 = '2021/11/30 23:59:04'
----------------------------------
Timestamp: 00:00:39.050
Insert Into PATS_IN_TRANSFERRING ( PATIENT_ID , DEPT_TRANSFERED_FROM , DEPT_TRANSFERED_TO , TRANSFER_DATE_TIME ) Values ( :1 , 
Null , :2 , :3 )
:1 = 'M0044437'
:2 = '3705'
:3 = '2021/11/30 23:59:04'
----------------------------------
Timestamp: 00:00:39.106
select count ( *) from pre_dischged_pats where patient_id =:1
:1 = 'M0044437'
----------------------------------
Timestamp: 00:00:39.164
INSERT INTO "PAT_VISIT" ( "PATIENT_ID", "IDENTITY", "OCCUPATION", "MARITAL_STATUS", "ARMED_SERVICES", "DUTY", 
"UNIT_IN_CONTRACT", "MAILING_ADDRESS", "ZIP_CODE", "NEXT_OF_KIN", "RELATIONSHIP", "NEXT_OF_KIN_PHONE", "NEXT_OF_KIN_ADDR", 
"PHONE_NUMBER_BUSINESS", "PATIENT_CLASS", "ADMISSION_CAUSE", "PAT_ADM_CONDITION", "CONSULTING_DATE", "DEPT_ADMISSION_TO", 
"CONSULTING_DOCTOR", "ADMISSION_DATE_TIME", "DEPT_DISCHARGE_FROM", "VISIT_ID", "DISCHARGE_DATE_TIME", "INSURANCE_TYPE", 
"ADMITTED_BY", "WORKING_STATUS", "INSURANCE_NO", "TOP_UNIT", "SERVICE_SYSTEM_INDICATOR", "SERVICE_AGENCY", "INSURANCE_AERA", 
"CHARGE_TYPE", "SEND_DEPT" ) VALUES ( :1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15, :16, :17, :18, :19, :20,
 :21, :22, :23, :24, :25, :26, :27, :28, :29, :30, :31, :32, :33, :34 )
:1 = 'M0044437'
:2 = '一般人员'
:3 = 'P'
:4 = '已婚'
:5 = '地方'
:6 = <NULL>
:7 = <NULL>
:8 = 'cq'
:9 = <NULL>
:10 = <NULL>
:11 = <NULL>
:12 = <NULL>
:13 = 'cq'
:14 = <NULL>
:15 = '1'
:16 = '治疗'
:17 = '3'
:18 = '2021/11/30 23:59:04'
:19 = '3705'
:20 = <NULL>
:21 = '2021/11/30 23:59:04'
:22 = <NULL>
:23 = '1'
:24 = <NULL>
:25 = '医疗保险'
:26 = '管理员'
:27 = <NULL>
:28 = <NULL>
:29 = <NULL>
:30 = <NULL>
:31 = <NULL>
:32 = <NULL>
:33 = '自费'
:34 = <NULL>
```

### 进入护士工作站 将病人新入 分配病床

选择住院登记的 妇产科，否则看不到自己的病人

![image-20211201002203603](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211201002203603.png)

### 这时会加载一些待入科信息

```
----------------------------------
Timestamp: 00:27:28.917
select * from comm.input_type where input_code<>'00' order by input_code
----------------------------------
Timestamp: 00:27:29.277
SELECT "PAT_MASTER_INDEX"."NAME", "PAT_MASTER_INDEX"."PATIENT_ID", "PATS_IN_TRANSFERRING"."DEPT_TRANSFERED_FROM", 
"PATS_IN_TRANSFERRING"."DEPT_TRANSFERED_TO", "DEPT_VS_WARD"."WARD_CODE" FROM "PAT_MASTER_INDEX", "DEPT_VS_WARD", 
"PATS_IN_TRANSFERRING", "DEPT_DICT" WHERE ( dept_vs_ward.dept_code (+) = dept_dict.dept_code) AND ( 
"PAT_MASTER_INDEX"."PATIENT_ID" = "PATS_IN_TRANSFERRING"."PATIENT_ID" ) AND ( "PATS_IN_TRANSFERRING"."DEPT_TRANSFERED_TO" = 
"DEPT_DICT"."DEPT_CODE" ) AND ( ( "PATS_IN_TRANSFERRING"."DEPT_TRANSFERED_FROM" IS NULL ) )
```

### 选择自己的病人入科，会自动加载病人信息

```
Timestamp: 00:29:03.802
SELECT "PATS_IN_HOSPITAL"."BED_NO", "PAT_MASTER_INDEX"."NAME", "PAT_MASTER_INDEX"."SEX", ROUND(MONTHS_BETWEEN(SYSDATE,
"PAT_MASTER_INDEX"."DATE_OF_BIRTH"),2), "PATS_IN_HOSPITAL"."ADMISSION_DATE_TIME", "PATS_IN_HOSPITAL"."ADM_WARD_DATE_TIME", 
"PATS_IN_HOSPITAL"."DIAGNOSIS", "PATS_IN_HOSPITAL"."NURSING_CLASS", "PATS_IN_HOSPITAL"."OPERATING_DATE", 
"PATS_IN_HOSPITAL"."DOCTOR_IN_CHARGE", "PATS_IN_HOSPITAL"."PATIENT_CONDITION", "PAT_VISIT"."CHARGE_TYPE", 
"PATS_IN_HOSPITAL"."WARD_CODE", "PATS_IN_HOSPITAL"."PATIENT_ID", "PATS_IN_HOSPITAL"."VISIT_ID", "PATS_IN_HOSPITAL"."DEPT_CODE", 
"PAT_MASTER_INDEX"."INP_NO", "PATS_IN_HOSPITAL"."PREPAYMENTS",
"PATS_IN_HOSPITAL"."TOTAL_CHARGES",
"BED_REC"."BED_LABEL",
"PAT_VISIT"."BODY_WEIGHT",
"PAT_VISIT"."BODY_HEIGHT" ,
'              ' as SUPER_DOCTOR_ID ,
'               ' as PARENT_DOCTOR_ID
FROM "PATS_IN_HOSPITAL", "PAT_MASTER_INDEX", "PAT_VISIT" ,"BED_REC"
WHERE ( "PATS_IN_HOSPITAL"."PATIENT_ID" = "PAT_MASTER_INDEX"."PATIENT_ID" ) AND ( "PAT_MASTER_INDEX"."PATIENT_ID" = 
"PAT_VISIT"."PATIENT_ID" ) AND ( "PAT_VISIT"."VISIT_ID" = "PATS_IN_HOSPITAL"."VISIT_ID" ) AND ( "BED_REC"."WARD_CODE" (+)= 
"PATS_IN_HOSPITAL"."WARD_CODE" ) AND ( "BED_REC"."BED_NO" (+)= "PATS_IN_HOSPITAL"."BED_NO" ) AND ( PATS_IN_HOSPITAL.PATIENT_ID 
= :ID )
:ID = 'M0044437'
```

### 入科确定

```
----------------------------------
Timestamp: 00:30:17.853
select dept_code , order_group from doctor_group where doctor_user =:1
:1 = 'LP'
----------------------------------
Timestamp: 00:30:17.900
INSERT INTO ORDERS_group_REC ( PATIENT_ID , VISIT_ID , dept_code , ORDER_GROUP , ORDER_DOCTOR , doctor_user , SUPER_DOCTOR_ID , 
PARENT_DOCTOR_ID ) VALUES ( :1 , :2 , :3 , :4 , :5 , :6 , :7 , :8 )
:1 = 'M0044437'
:3 = '3705'
:4 = '3705'
:5 = '刘苹'
:6 = 'LP'
:7 = <NULL>
:8 = <NULL>
----------------------------------
Timestamp: 00:30:17.978
DELETE pats_in_transferring WHERE patient_id =:1
:1 = 'M0044437'
----------------------------------
Timestamp: 00:30:18.010
SELECT dept_admission_to from pat_visit WHERE patient_id =:1 and visit_id =:2
:1 = 'M0044437'
----------------------------------
Timestamp: 00:30:18.041
update pat_visit set dept_admission_to =:1 , adt_room_no =:2 where patient_id =:3 and visit_id =:4
:1 = '3705'
:2 = '45'
:3 = 'M0044437'
----------------------------------
Timestamp: 00:30:18.088
update pat_visit set body_weight =:1 , body_height =:2 WHERE Patient_id =:3 and Visit_id =:4
:1 = <NULL>
:2 = <NULL>
:3 = 'M0044437'
```

### 进入医生站 新建 后才会显示在列表中

![image-20211201004559508](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211201004559508.png)

### 进入医生工作站，进行治疗



添加处方

![image-20211201005153773](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211201005153773.png)

```
Timestamp: 00:51:20.835
select price , prefer_price , foreigner_price from current_price_list where item_class =:1 and item_code =:2 and upper ( 
item_spec ) =upper ( :3 ) and units =:4
:1 = 'A'
:2 = '3202003SS0'
:3 = '0.3g*24陕西方舟'
:4 = '盒'
----------------------------------
Timestamp: 00:51:20.944
select charge_special_indicator from CHARGE_PRICE_SCHEDULE where charge_type =:1
:1 = '自费'
----------------------------------
Timestamp: 00:51:21.006
SELECT proportion_numerator , proportion_denominator , free_limit FROM charge_special_except_dict WHERE charge_type =:1 AND 
item_class =:2 AND ( item_code =:3 OR item_code ='*' ) AND ( item_spec =:4 OR item_spec ='*' )
:1 = '自费'
:2 = 'A'
:3 = '3202003SS0'
:4 = '0.3g*24陕西方舟'
----------------------------------
Timestamp: 00:51:21.085
SELECT proportion_numerator , proportion_denominator , free_limit FROM charge_special_item_dict WHERE charge_type =:1 AND 
item_class =:2 AND ( item_code =:3 OR item_code ='*' ) AND ( item_spec =:4 OR item_spec ='*' )
:1 = '自费'
:2 = 'A'
:3 = '3202003SS0'
:4 = '0.3g*24陕西方舟'
----------------------------------
Timestamp: 00:51:21.168
SELECT distinct "DRUG_STOCK"."STORAGE", '' serial,
0 flag, "DRUG_PRICE_LIST"."DRUG_CODE", "DRUG_PRICE_LIST"."DRUG_SPEC", "DRUG_PRICE_LIST"."FIRM_ID", "DRUG_PRICE_LIST"."UNITS", 
"DRUG_PRICE_LIST"."MIN_SPEC", "DRUG_STOCK"."SUB_STORAGE", "DRUG_STORAGE_DEPT"."STORAGE_NAME", 
"DRUG_PRICE_LIST"."AMOUNT_PER_PACKAGE" FROM "DRUG_PRICE_LIST", "DRUG_STOCK", "DRUG_STORAGE_DEPT" WHERE ( "DRUG_STOCK"."STORAGE" 
= "DRUG_STORAGE_DEPT"."STORAGE_CODE" ) and ( "DRUG_STOCK"."DRUG_CODE" = "DRUG_PRICE_LIST"."DRUG_CODE" ) and ( 
"DRUG_STOCK"."DRUG_SPEC" = "DRUG_PRICE_LIST"."MIN_SPEC" ) and ( "DRUG_STOCK"."UNITS" = "DRUG_PRICE_LIST"."MIN_UNITS" ) and ( 
"DRUG_STOCK"."FIRM_ID" = "DRUG_PRICE_LIST"."FIRM_ID" ) and ( ( "DRUG_STOCK"."SUPPLY_INDICATOR" = 1 ) AND
( "DRUG_STOCK"."STORAGE" = :STORE_DEPTS) AND ( "DRUG_STOCK"."DRUG_CODE" = :drug_code )) AND
( "DRUG_PRICE_LIST"."STOP_DATE" IS NULL)
:STORE_DEPTS = '0703'
:drug_code = '3202003SS0'
----------------------------------
Timestamp: 00:51:21.256
SELECT DRUG_DICT.DOSE_UNITS , DRUG_PRICE_LIST.AMOUNT_PER_PACKAGE *DRUG_DICT.DOSE_PER_UNIT dosage FROM DRUG_PRICE_LIST , 
DRUG_DICT WHERE DRUG_PRICE_LIST.DRUG_CODE =DRUG_DICT.DRUG_CODE AND DRUG_PRICE_LIST.MIN_SPEC =DRUG_DICT.DRUG_SPEC AND 
DRUG_PRICE_LIST.MIN_UNITS =DRUG_DICT.UNITS AND ( ( DRUG_PRICE_LIST.START_DATE <= sysdate and DRUG_PRICE_LIST.STOP_DATE >= 
sysdate ) OR ( DRUG_PRICE_LIST.START_DATE <= sysdate AND DRUG_PRICE_LIST.STOP_DATE IS NULL ) ) and DRUG_PRICE_LIST.DRUG_CODE 
=:1 AND DRUG_PRICE_LIST.DRUG_SPEC =:2 AND DRUG_PRICE_LIST.FIRM_ID =:3 AND rownum <= 1
:1 = '3202003SS0'
:2 = '0.3g*24'
:3 = '陕西方舟'
```

### 添加添加处方成功

![image-20211201005352712](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211201005352712.png)

```
Timestamp: 00:52:18.367
INSERT INTO "ORDERS" ( "START_DATE_TIME", "ORDER_TEXT", "DOSAGE", "DOSAGE_UNITS", "ADMINISTRATION", "DURATION", 
"DURATION_UNITS", "FREQUENCY", "FREQ_COUNTER", "FREQ_INTERVAL", "FREQ_INTERVAL_UNIT", "DOCTOR", "NURSE", "STOP_DOCTOR", 
"ORDER_CLASS", "REPEAT_INDICATOR", "STOP_DATE_TIME", "ORDER_CODE", "ORDER_STATUS", "ENTER_DATE_TIME", "FREQ_DETAIL", 
"PATIENT_ID", "VISIT_ID", "ORDER_NO", "ORDER_SUB_NO", "PERFORM_SCHEDULE", "BILLING_ATTR", "LAST_ACCTING_DATE_TIME", 
"PERFORM_RESULT", "LAST_PERFORM_DATE_TIME", "ORDERING_DEPT", "STOP_NURSE", "DRUG_BILLING_ATTR", "DOCTOR_USER", 
"VERIFY_DATA_TIME", "ORDER_PRINT_INDICATOR", "PROCESSING_DATE_TIME", "PROCESSING_NURSE", "STOP_PROCESSING_NURSE", 
"STOP_PROCESSING_DATE_TIME", "CURRENT_PRESC_NO", "CANCEL_DATE_TIME", "CANCEL_DOCTOR", "DEGREE" ) VALUES ( :1, :2, :3, :4, :5, 
:6, :7, :8, :9, :10, :11, :12, :13, :14, :15, :16, :17, :18, :19, :20, :21, :22, :23, :24, :25, :26, :27, :28, :29, :30, :31, 
:32, :33, :34, :35, :36, :37, :38, :39, :40, :41, :42, :43, :44 )
:1 = '2021/12/1 0:52:18'
:2 = '阿胶当归胶囊'
:3 = '1.0000'
:4 = 'g'
:5 = '遵医嘱'
:6 = <NULL>
:7 = <NULL>
:8 = 'qd'
:9 = <NULL>
:10 = <NULL>
:11 = <NULL>
:12 = '管理员'
:13 = <NULL>
:14 = <NULL>
:15 = 'A'
:16 = '0'
:17 = <NULL>
:18 = '3202003SS0'
:19 = '1'
:20 = '2021/12/1 0:52:18'
:21 = '1/盒/无'
:22 = 'M0044437'
:23 = '1'
:24 = '1'
:25 = '1'
:26 = <NULL>
:27 = '5'
:28 = <NULL>
:29 = <NULL>
:30 = <NULL>
:31 = '3705'
:32 = <NULL>
:33 = '5'
:34 = 'FYADMIN'
:35 = <NULL>
:36 = <NULL>
:37 = <NULL>
:38 = <NULL>
:39 = <NULL>
:40 = <NULL>
:41 = '1762'
:42 = <NULL>
:43 = <NULL>
:44 = <NULL>
----------------------------------
Timestamp: 00:52:18.820
INSERT INTO "DOCT_DRUG_PRESC_MASTER" ( "PATIENT_ID", "VISIT_ID", "NAME", "NAME_PHONETIC", "PRESC_DATE", "IDENTITY", 
"CHARGE_TYPE", "ORDERED_BY", "PRESCRIBED_BY", "PRESC_ATTR", "DISPENSARY", "PRESC_SOURCE", "UNIT_IN_CONTRACT", "PRESC_NO", 
"PRESC_TYPE", "REPETITION", "COSTS", "PAYMENTS", "ENTERED_BY", "PRESC_STATUS", "DISPENSING_PROVIDER", "COUNT_PER_REPETITION", 
"USAGE", "BINDING_PRESC_TITLE", "DISCHARGE_TAKING_INDICATOR", "DOCTOR_USER", "DECOCTION", "NEWLY_PRINT", "DIAGNOSIS_NAME" ) 
VALUES ( :1, :2, :3, :4, :5, :6, :7, :8, :9, :10, :11, :12, :13, :14, :15, :16, :17, :18, :19, :20, :21, :22, :23, :24, :25, 
:26, :27, :28, :29 )
:1 = 'M0044437'
:2 = '1'
:3 = '陈伟TEST'
:4 = 'CHEN WEI TEST'
:5 = '2021/12/1 0:47:51'
:6 = '一般人员'
:7 = '自费'
:8 = '3705'
:9 = '管理员'
:10 = <NULL>
:11 = '0703'
:12 = '1'
:13 = ''
:14 = '1762'
:15 = '0'
:16 = '1'
:17 = '32.1800'
:18 = '32.1800'
:19 = '管理员'
:20 = '0'
:21 = <NULL>
:22 = '1'
:23 = <NULL>
:24 = <NULL>
:25 = '1'
:26 = 'FYADMIN'
:27 = <NULL>
:28 = <NULL>
:29 = '不详'
----------------------------------
Timestamp: 00:52:19.101
INSERT INTO "DOCT_DRUG_PRESC_DETAIL" ( "PRESC_DATE", "PRESC_NO", "ITEM_NO", "ORDER_NO", "ORDER_SUB_NO", "DRUG_CODE", 
"DRUG_SPEC", "DRUG_NAME", "FIRM_ID", "PACKAGE_SPEC", "PACKAGE_UNITS", "QUANTITY", "COSTS", "PAYMENTS", "ADMINISTRATION", 
"DOSAGE", "DOSAGE_UNITS", "AMOUNT_PER_PACKAGE", "FREQUENCY", "DOSAGE_EACH", "FREQ_DETAIL" ) VALUES ( :1, :2, :3, :4, :5, :6, :7,
 :8, :9, :10, :11, :12, :13, :14, :15, :16, :17, :18, :19, :20, :21 )
:1 = '2021/12/1 0:47:51'
:2 = '1762'
:3 = '1'
:4 = '1'
:5 = '1'
:6 = '3202003SS0'
:7 = '0.3g*24陕西方舟'
:8 = '阿胶当归胶囊'
:9 = '陕西方舟'
:10 = '0.3g*24'
:11 = '盒'
:12 = '1.00'
:13 = '32.1800'
:14 = '32.1800'
:15 = '遵医嘱'
:16 = '7.2000'
:17 = 'g'
:18 = <NULL>
:19 = 'qd'
:20 = '1.0000'
:21 = '1/盒/无'
----------------------------------
```

部分退费， 退费，

# 12月1日

任务：熟悉医生工作站、护士工作站对病人的相关操作。

![image-20211201154821609](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211201154821609.png)



倒数第二，和1,2 是重点



妇产科护士站

检查子系统

体温

手术 开药单 药房 领药



检查 进入对应科室 先确认保存，在书写报告



# 12月2日

## 任务：熟悉药库药房的操作

## 1 医生工作站，开药执行时间输错，导致后续操作报错，只有跟踪sql去数据库删除了。

![image-20211202143638048](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202143638048.png)

```
SELECT charge_type FROM pat_visit WHERE patient_id =:1 and visit_id =:2
:1 = 'M0044437'
----------------------------------
Timestamp: 14:35:21.008
SELECT "PRICE_LIST"."ITEM_CODE" , "PRICE_LIST"."UNITS" , "PRICE_LIST"."PRICE" FROM "PRICE_LIST" WHERE "PRICE_LIST"."ITEM_CLASS" 
=:1 and "PRICE_LIST"."ITEM_CODE" =:2 AND sysdate >= "START_DATE" and "PRICE_LIST"."ITEM_SPEC" =:3 and ( 
"PRICE_LIST"."STOP_DATE" IS NULL or SYSDATE <= "STOP_DATE" )
:1 = 'A'
:2 = '0105002XJ0'
:3 = '50ml成都倍特'
```

## 2 重新挂号测试

M0044437

挂号

12月2日下午李露老师培训，java自助机相关



![image-20211202165027750](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202165027750.png)

![image-20211202165720065](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202165720065.png)

![image-20211202165830386](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202165830386.png)

退费

![image-20211202165938837](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202165938837.png)

收据号

![image-20211202170033875](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202170033875.png)

![image-20211202170108278](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202170108278.png)

![image-20211202170308374](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202170308374.png)

![image-20211202170413506](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202170413506.png)

rctp：结算

![image-20211202170742180](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202170742180.png)	

_t临时表  temp

![image-20211202170929715](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202170929715.png)

exam 检查

lab 检验

appoints申请

![image-20211202171110671](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202171110671.png)

indicator 缴费的标志



药品

![image-20211202171303269](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202171303269.png)



![image-20211202171440261](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202171440261.png)

预交金

![image-20211202171711588](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202171711588.png)	退费（会生成一个负记录），作废（没哟结账)，

![image-20211202171821840](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202171821840.png)



![image-20211202171923541](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202171923541.png)

![image-20211202171958273](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202171958273.png)

门诊 outp中途结算

![image-20211202172139018](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202172139018.png)

住院结算

sql

![image-20211202173546144](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202173546144.png)

插件

![image-20211202173559399](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202173559399.png)

医院编码

![image-20211202173725068](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202173725068.png)

![image-20211202173734410](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202173734410.png)

![image-20211202173738362](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211202173738362.png)

# 12月3日

## 任务：

1 诊间挂号 上午 下午 夜间 昼夜 白天 的测试

2 诊间挂号pb 关于fileter的使用，就是不使用if else去做挂号时间段，能不能使用filter

3 诊间挂号 剩余挂号 看原来作者是否写好，没写好自己需要改

4 java pdfscan读取pdf

5 培训his操作流程再操作，并记录

6 熟悉公司java相关项目

7 诊间挂号 配置文件读取的问题，完善，就是不要自己设置下午是1点开始，而是从配置文件读取

8 关于挂号费问题，挂号费是诊察费

### 1 诊间挂号 上午 下午 夜间 昼夜 白天 的测试

上 查看门诊挂号内容

![image-20211203092717158](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211203092717158.png)

和诊间挂号对比

![image-20211203093140767](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211203093140767.png)

一致

[PB setfilter函数详解_duanwenzhi00的专栏-CSDN博客](https://blog.csdn.net/duanwenzhi00/article/details/7573190?spm=1001.2101.3001.6650.6&utm_medium=distribute.pc_relevant.none-task-blog-2~default~OPENSEARCH~default-6.opensearchhbase&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~OPENSEARCH~default-6.opensearchhbase)

下午测试

![image-20211203151754184](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211203151754184.png)

![image-20211203153200762](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211203153200762.png)

### 8 关于挂号费问题，挂号费是诊察费，而不是诊疗费

关于挂号费问题，挂号费是诊察费，而不是诊疗费吧，测试数据有个诊察费，导致门诊挂到骨科-彭林时，这时一条脏数据   去门诊测试一下可以挂到骨科-彭林的号不。通过测试发现，挂他的号显示0元，而他是副高号不应该是0元。这就说明门诊挂号有问题，如果存在脏数据，导致费用类型不是诊察费，会导致挂号为0元二挂号成功。虽然脏数据的概率小，但程序上还是需要做判断。

![image-20211125221350411](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211125221350411.png)

挂号的费用并不是通过charge_item来确定的，而是通过clinic_type来确认price_item从而找到价格。

前面错误是看同事代码，跟着他的思路写的，现在才发现他是错的。。。

```
----------------------------------
Timestamp: 09:58:48.362
select count ( *) from pat_master_index where patient_id =:1
:1 = 'M0044437'
----------------------------------
Timestamp: 09:58:48.400
select patient_id from pat_master_index where patient_id =:1
:1 = 'M0044437'
----------------------------------
Timestamp: 09:58:48.485
select sysdate from dual
----------------------------------
Timestamp: 09:58:48.524
SELECT TO_CHAR ( SYSDATE , 'yyyymmdd' ) || LPAD ( TO_CHAR ( OUTPBILL.SQ_RCPT_NUMBER.NEXTVAL ) , 6 , '0' ) , 
OUTPBILL.SQ_RCPT_NUMBER.NEXTVAL FROM DUAL
----------------------------------
Timestamp: 09:58:48.576
select count ( *) from clinic_master where visit_date =trunc ( sysdate ) and visit_no =:1
:1 = 626
----------------------------------
Timestamp: 09:58:48.620
select clinic_type , clinic_position , clinic_dept , doctor from CLINIC_INDEX where CLINIC_LABEL =:1
:1 = '骨科-彭林'
----------------------------------
Timestamp: 09:58:48.691
select id , id_no , name from staff_dict where emp_no =:1
:1 = 'PL'
----------------------------------
Timestamp: 09:58:48.723
select price_item from clinic_type_setting where charge_item =:1 and clinic_type =:2
:1 = '诊察费'
:2 = '副高号'
----------------------------------
Timestamp: 09:58:48.765
SELECT VISIT_NO.NEXTVAL FROM DUAL
----------------------------------
Timestamp: 09:58:48.802
select dept_name from dept_dict where dept_code =:1
:1 = '3709'
----------------------------------
Timestamp: 09:58:48.844
insert into outpbill.clinic_payments_money ( visit_date , visit_no , payment_no , money_type , payment_amount , refunded_amount 
) values ( :1 , :2 , 1 , '现金' , :3 , '0' )
:1 = '2021/12/3'
:2 = 1471
:3 = '0'
```

![image-20211203100729275](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211203100729275.png)

![image-20211203100807920](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211203100807920.png)

![image-20211203101009657](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211203101009657.png)

通过上面三张图和sql跟踪，可以发现他的挂号费是不对的，原因就是门诊挂号程序是通过charge_item和clinic_type找到价表，而这里没有诊查费和副高号的组合，导致费用为0

```
select price_item from clinic_type_setting where charge_item =:1 and clinic_type =:2
:1 = '诊察费'
:2 = '副高号'
```

这个脏数据，在我的诊间挂号上直接体现为医生显示不出来，

我那里显示不出来是因为本来就没有彭林这个医生



```
SELECT "OUTP_MR"."PATIENT_ID", "OUTP_MR"."VISIT_DATE", "OUTP_MR"."VISIT_NO", "OUTP_MR"."ILLNESS_DESC", "OUTP_MR"."ANAMNESIS", 
"OUTP_MR"."FAMILY_ILL", "OUTP_MR"."MARRITAL", "OUTP_MR"."INDIVIDUAL", "OUTP_MR"."MENSES", "OUTP_MR"."MED_HISTORY", 
"OUTP_MR"."BODY_EXAM", "OUTP_MR"."DIAG_DESC", "OUTP_MR"."ADVICE", "OUTP_MR"."DOCTOR", "OUTP_MR"."ORDINAL", 
"OUTP_MR"."OPERATION_RECORD", "OUTP_MR"."MEDICAL_RECORD", "OUTP_MR"."DOCTOR_NO", "OUTP_MR"."TOOTH", "OUTP_MR"."MEMO", 
"OUTP_MR"."CDIAG", "OUTP_MR"."ILLNESS_DATE", "OUTP_MR"."MATERNITY",
"OUTP_MR".flag_birth,flag_infect
FROM "OUTP_MR" WHERE ( "OUTP_MR"."VISIT_DATE" = '2021/12/3' ) AND ( "OUTP_MR"."VISIT_NO" = 1504 ) AND ( 
"OUTP_MR"."DOCTOR_NO" = 'FYADMIN' )
:ad_visit_date = '2021/12/3'
:ai_visit_no = 1504
:as_doctor = 'FYADMIN'
```



## 培训

![image-20211203103717638](C:\Users\11839\AppData\Roaming\Typora\typora-user-images\image-20211203103717638.png)

```
	
```

22994.57999999999
229.9457999999999





11月15 pb视频学习

22-26  姜老师培训

29 张老师培训

30 31 12月1 朱老师培训

12月2日 李露老师培训java自助机

12月3日 杨老师培训java insurance 跑前段项目



java相关：

开始看的那个controller策略，李露老师说更改了策略模式，修改了设计模式。

aop：日志

[Spring的核心是控制反转(IOC)和面向切面编程(AOP)及SpringCloud和 SpringBoot 的关系_Ssssongsmith 天璇星-CSDN博客](https://blog.csdn.net/rinvay_cui/article/details/109829423)

